## 第三轮优化计划

### 阶段一：性能优化（破坏性重构）

1. **优化 `writeLowerASCII` 为单次遍历**
   - 文件：`scan/scan.go`
   - 移除双重遍历，检查到非ASCII时直接调用 `strings.ToLower`

2. **用 `strconv.Itoa` 替代手写 `intToString`**
   - 文件：`builder/arg_builder.go`
   - 简化代码，利用标准库优化

3. **合并 `rewriteQuestionPlaceholders` 和 `rewritePostgresQuestionPlaceholders`**
   - 文件：`builder/arg_builder.go`
   - 提取公共 SQL 解析状态机
   - 预期减少约 200 行重复代码

### 阶段二：代码清理

4. **统一错误消息格式**
   - 规范化所有 "corm: ..." 错误消息

5. **合并 `quoteSelectColumnStrict` 和 `quoteIdentStrict`**
   - 文件：`builder/internal.go`
   - 提取公共的 dot 分隔逻辑

### 阶段三：发布

6. **运行完整测试**
7. **提交代码到 main 分支**
8. **创建 v1.1.2 tag**

### 预计变更文件
- `scan/scan.go`
- `builder/arg_builder.go`
- `builder/internal.go`
- `builder/advanced_test.go`（可能需要更新测试）

### 预计代码减少
- 删除重复代码约 200 行
- 整体代码更清晰、可维护性更高